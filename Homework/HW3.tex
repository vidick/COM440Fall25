\documentclass[12pt]{article}
\usepackage{fullpage}
\usepackage{amssymb,amsmath}

\newtheorem{theorem}{Theorem}

 \newcommand{\Header}[1]{\begin{center} {\Large\bf #1} \end{center}}
 \newcommand{\header}[1]{\begin{center} {\large\bf #1} \end{center}}
\setlength{\parindent}{0.0in}
\setlength{\parskip}{1ex}


%\newif\ifnotes\notestrue
\newif\ifnotes\notesfalse


\input{../com440-default.tex}
\input{../com440-macros.tex}


\begin{document}
\header{COM-440, Introduction to Quantum Cryptography, Fall 2025}
{\bf Homework \# 3} \hfill {\bf due: 12:59PM, {\color{blue}October 19th}, 2025}


\medskip

\hrule

\medskip 

Ground rules: 

{\bf Please
  format your solutions so that each problem begins on a new page, and
  so that your name appears at the top of each page.}

You are encouraged to collaborate with your classmates on
homework problems, but each person must write up the final solutions
individually. You should note on your homework specifically which
problems were a collaborative effort and with whom. You may not search
online for solutions, but if you do use research papers or other
sources in your solutions, you must cite them. If you use an AI tool to 
partially solve a question, or improve your write-up of a solution, then 
you should also mention it. All questions on the homework, including requests for clarifications or typos, should be directed to the Ed forum.

Late homework will not be accepted or graded. Extensions will not be granted, except on the recommendation of an academic committee. 

Each of the four problem set counts for 20\% of the total homework grade. (Each of the two readings will count for 10\% of the final homework grade.)


\medskip

\hrule

\medskip



Revisions since the first posting are in \textcolor{blue}{blue}.

{\bf Problems:}
\begin{enumerate}



\item \emph{(6 points)} {\bf Information reconciliation via linear codes.}
Suppose Alice and Bob have access to the the binary symmetric channel with
error $p$: Bob receives each bit that Alice sends correctly with probability $(1-p)$, and incorrectly with probability $p$. In other words, Alice has a uniformly random $X_A \in \{0,1\}^7$ and Bob has $X_B \in \{0,1\}^7$ such that each bit of $X_B$ equals the same bit of $X_A$ with probability $(1-p)$. 
\begin{enumerate}
\item 
Consider the linear code generated by the parity check matrix
\[H = \begin{pmatrix} 0 & 0 & 0 & 1 & 1 & 1 & 1 \\
0 & 1 & 1 & 0 & 0 & 1 & 1 \\
1 & 0 & 1 & 0 & 1 & 0 & 1
\end{pmatrix}\;.\]
Show that this code corrects a single error. 
\item
Using the information reconciliation scheme from class (described in the Chapter 6 notes), with what probability do Alice and Bob succeed in performing reconciliation on their strings (thus obtaining an identical $7$-bit key)?
\item What is the probability that a $7$-bit message is transmitted correctly with no
reconciliation? Compare this to the success probability of the previous part and
to the success probability of the $3$-bit scheme generated by the parity check matrix
\[H = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 1 & 1\end{pmatrix}\;.\]
Which scheme has success probability with the best leading order
behavior? For $p\in \big(0,\frac{1}{2}\big)$, which scheme is best?
\end{enumerate}

\item \emph{(6 points)} {\bf Establishing keys in the presence of a limited eavesdropper.}
In all settings below, we assume that Alice and Bob are connected by a classical authenticated channel. 
Your goal is to devise ways in which Alice and Bob can obtain a key in any of the situations below. \emph{[Hint: In both cases, start by evaluating $\Hmin(X|E)$ where $X$ is the string shared by Alice and Bob after transmission and $E$ is Eve's (classical) information about it.]}
\begin{enumerate}
\item[(a)] Suppose that Alice and Bob are connected by a classical channel such that Eve learns each bit with probability exactly $q$, where we only know that
$1/3 \leq q \leq 1/2$. (Bob always receives the correct bit.)
Give a protocol that allows Alice and Bob to create an $\epsilon$-secure key, where $\epsilon = 10^{-5}$. Explain why your protocol is secure. How many uses of the channel are required per bit of key produced? 
\item[(b)] Suppose now that Alice and Bob are connected by a classical channel on which Eve can intercept bits arbitrarily. However, Eve's memory 
is limited to $k = 1024$ bits. (Bob always receives the correct bit.) Give a protocol that allows Alice and Bob to create an $\epsilon$-secure key where $\epsilon = 10^{-10}$. 
Explain why your protocol is secure.
\end{enumerate}


\item \emph{(8 points)} {\bf Cloning attacks NEED TO EDIT BASED ON PDF}\\ 
In this problem we study the effectiveness of a simple cloning attack for the eavesdropper in the BB84 key distribution protocol. Recall that in the protocol Alice prepares $N$ single-qubit states $\ket{x_j}_{\theta_j}$, for $j\in\{1,\ldots,N\}$ and random $x_j,\theta_j\in\{0,1\}$, and sends each of these states to Bob. 

Now suppose the eavesdropper Eve intercepts each of the states sent by Alice, and does the following: 
\begin{enumerate}
\item[(i)] With probability $1-p$, she applies the cloning map $T_1$ from Problem 6(a) in HW2. She keeps the second qubit and forwards the first qubit to Bob. 
\item[(ii)] With probability $p$, she applies the cloning map $T_2$ from Problem 6(b) in HW2. She keeps the second qubit, traces out (i.e. ignores) the third qubit, and forwards the first to Bob. 
\end{enumerate}
For simplicity, first assume $N=1$. Based on the results of HW2 Problem 6 (you may consult the solution available online), evaluate the following:
\begin{enumerate}
\item[(a)] Suppose both Alice and Bob measure their qubit in the correct basis $\theta=\theta_1$. If $p=0$, what is the probability that they get the same outcome (recall $\theta\in\{0,1\}$ is chosen uniformly at random). Same question if $p=1$. Same question for a general $0<p<1$. \tnote{For this first question it may be helpful to give them the answer and ask them to prove it; to build confidence and avoid silly mistakes that would make them get all the questions wrong}
\item[(b)] Answer the same questions, where now Alice and Eve measure their qubit. What is the probability that they get the same outcome? 
\item[(c)] What is the probability that all of Alice, Bob and Eve all obtain the same outcome, if they each measure their respective qubit in basis $\theta$? (Answer for a general $p$.)
\end{enumerate}
\tnote{answers to the questions will be important for the rest. Are they in the HW2 solutions? If not, maybe we should give them away, or find a way to replace whatever answer they got by a parameter, so they don't lose points later if they get it wrong here.}
Let's continue with the BB84 protocol. We now consider a number of rounds $N=4n$. Suppose that in $2n$ of the rounds (exactly), Alice and Bob happen to make the same basis choice; call these the agreement rounds, $R\subseteq\{1,\ldots,N\}$. They select exactly $n$ of these rounds for testing; call these rounds the testing rounds, $T \subseteq R$. You may assume all rounds behave the same. 
\begin{enumerate}
\item[(d)] What is the expected number of errors (non-agreement of their measurement outcomes) that Alice and Bob will notice in the testing rounds $T$, as a function of $p$?
\item[(e)] Invert the previous bound: as a function of the fraction $\delta$ of errors detected in the testing rounds, what is a reasonable estimate $\hat{p}$ for $p$ that Alice and Bob could come up with? 
\item[(f)] Suppose Alice and Bob make a guess $\hat{p}$ for $p$ based on the method from the previous question. Using question (b), deduce a bound on the min-entropy $\Hmin(A|E)$ per round that they could estimate for the rounds in $K = R\backslash T$. 
\item[(g)] Conclude: how many bits of key, as a function of $p$ and $N$, can Alice and Bob reasonably hope to generate from the protocol? \emph{[Hint: This is a subtle calculation. Alice and Bob will have to perform both information reconciliation and privacy amplification on the rounds in $K$. First, estimate the number of bits they will need to exchange to perform information reconciliation. Second, deduce a bound on the min-entropy of the resulting agreed-on string. Third, use the best privacy amplification method you know of to maximize the length of extracted key]}
\tnote{I am not sure if this is too much. Maybe the question should be split in two. In any case I wouldn't want to put too many points on it: what's important is they get the idea, not necessarily every single number}
\end{enumerate}


\item {\bf Min-entropy from the matching outcomes bound}\label{ex:matching-min}\\
This problem investigates a direct method to lower bound Alice and Bob's key extraction rate based on the probability that the matching-outcomes test succeeds. If we assume that the adversary Eve prepares $n$ identical and uncorrelated copies of the tripartite state $\ket{\Psi_{ABE}}$ and sends the qubits $A$ to Alice and $B$ to Bob, then as shown in Chapter~\ref{chap:pa} the key extraction rate can be asymptotically lower-bounded by the min-entropy $\Hmin(X|E)$ per round, where $X$ is the outcome of Alice's measurement on her qubit. The goal of this problem is to prove a lower bound on this quantity.

Recall that if Alice measures her qubit in the standard basis, and the resulting post-measurement state on her qubit and Eve's system $E$ is a classical-quantum (cq) state
$$\rho_{XE} = \frac{1}{2}\ketbra{0}{0} \otimes \rho_E^{Z,0}+\frac{1}{2}\ketbra{1}{1} \otimes \rho_E^{Z,1},$$
then the optimal guessing probability $P_{guess}(X|E)$ such that
$$\Hmin(X|E) = - \log P_{guess}(X|E)$$
is given by the Helstr\"om measurement, for which
$P_{guess}(X|E) = \frac{1}{2}+\frac{1}{4}\|\rho_E^{Z,0}-\rho_E^{Z,1}\|_1.$

The same reasoning holds for any other choice of Alice's basis, notably the Hadamard basis $\{|+\rangle,|-\rangle\}$. In the BB'84 protocol Alice chooses with probability 1/2 one of the two bases in which to measure her qubit. If we denote by $P_{guess}(X|E,\Theta=X)$ and $P_{guess}(X|E,\Theta=1)$ the optimal guessing probabilities for Alice measuring in the standard ($\Theta=0$) and Hadamard ($\Theta=1$) bases respectively, the desired lower bound is given by
$$\Hmin(X|E\Theta) = -\log \left[\frac{1}{2}P_{guess}(X|E,\Theta=0)+\frac{1}{2}P_{guess}(X|E,\Theta=1)\right].$$
\begin{enumerate}
\item Suppose Alice and Bob share a pure EPR pair $\ket{\epr}$, uncorrelated with Eve's system: $\rho_{ABE} = \proj{\epr}_{AB} \otimes \rho_E$. What is $\Hmin(X|E)$?
%\solopen{Recall that $X$ is a single bit, the output of Alice's measurement. Therefore its min-entropy is upper-bounded by $1$. Since Eve is totally uncorrelated and Alice's local density matrix is $\frac12\id$, $X$ is a uniform random bit with respect to Eve's point of view. That is, $\Hmin(X\mid E) = 1$. }
%
% \begin{enumerate}[a)]
%     \item $\frac{1}{2}$
%     \item $\frac{1}{\sqrt{2}}$
%     \item $1$
%     \item $2$
% \end{enumerate}
%
\item Now consider the general case, where $\ket{\Psi_{ABE}}$ is an arbitrary state prepared by Eve. Let $p$ be the probability that this state succeeds in the matching outcomes test, when Alice and Bob both measure in the same basis $\Theta$ chosen at random. Give coefficients $a,b,c$ such that
$$p = a \bra{\Psi_{ABE}} X_A \otimes X_B \otimes \id_E \ket{\Psi_{ABE}} + b\bra{\Psi_{ABE}} Z_A \otimes Z_B \otimes \id_E \ket{\Psi_{ABE}} + c,$$
where $X,Z$ are the Pauli observables $X = \ketbra{0}{1} + \ketbra{1}{0}$ and $Z = \ketbra{+}{-} + \ketbra{-}{+}$.
%\solopen{We want to compute the probability that Alice and Bob obtain the same outcome. Suppose $\Theta = 0$, so that Alice and Bob both measure in the standard basis.
%The expected value of the product of their measurement outcomes is $\bra{\Psi_{ABE}} Z\otimes Z \otimes I \ket{\Psi_{ABE}}$. If they make the same measurement, then the product of their measurements is $+1$. If they make different measurements, this product is $-1$.
%Therefore the expectation is equal to $p_{\text{same}\mid\Theta = 0} - p_{\text{different}\mid\Theta = 0}$. These two probabilities sum to $1$, so we conclude that
%\[p_{\text{same}\mid\Theta = 0} = \frac12 + \frac 12\bra{\Psi_{ABE}} Z\otimes Z \otimes I \ket{\Psi_{ABE}}.\]
%Similarly,
%\[p_{\text{same}\mid\Theta = 1} = \frac12 + \frac 12\bra{\Psi_{ABE}} X\otimes X \otimes I \ket{\Psi_{ABE}}.\]
%Finally,
%\[
%p_{\text{same}} = \frac12 p_{\text{same}\mid\Theta = 0} + \frac 12 p_{\text{same}\mid\Theta = 0}
%= \frac12 + \frac 14\bra{\Psi_{ABE}} X\otimes X \otimes I \ket{\Psi_{ABE}}+ \frac 14\bra{\Psi_{ABE}} Z\otimes Z \otimes I \ket{\Psi_{ABE}}.
%\]}
\item Let $p_X$ (resp. $p_Z$) be the probability that the state $\ket{\Psi_{ABE}}$ passes the matching outcomes test in the Hadamard (resp. computational) basis, so that $p=\frac{1}{2}(p_X+p_Z)$.
By expanding the qubit $A$ in the computational basis, the state $\ket{\Psi_{ABE}}$ can be expressed as $\ket{\Psi_{ABE}} = \ket{0}\otimes\ket{u_0}_{BE} + \ket{1}\otimes\ket{u_1}_{BE}$, with $\|\ket{u_0}_{BE}\|^2+\|\ket{u_1}_{BE}\|^2=1$. Give coefficients $a',b'$ such that
$ \bra{\Psi_{ABE}} X_A \otimes X_B \otimes \id_E \ket{\Psi_{ABE}} = a'\, \Re(\bra{u_0} X_B \otimes \id_E \ket{u_1}) + b'.$
%\solopen{
%Applying the standard basis expansion suggested in the problem, along with the identity $X = \ketbra 01 + \ketbra 10$, we can rewrite $\bra{\Psi_{ABE}} X_A\otimes X_B \otimes I_E \ket{\Psi_{ABE}}$ as
%\[
%\left(\bra 0_A \otimes \bra{u_0}_{BE} +\bra 1_A \otimes \bra{u_1}_{BE}\right) \left[(\ketbra01 + \ketbra10)_A\otimes X_B\otimes I_E \right]\left(\ket 0_A\otimes \ket{u_0}_{BE} +\ket 1_A \otimes \ket{u_1}_{BE}\right).
%\]
%Evaluating inner products simplifies this to
%\[
%\bra{u_0}_{BE}X_B\otimes I_E\ket{u_1}_{BE} +
%\bra{u_1}_{BE}X_B\otimes I_E\ket{u_0}_{BE}.
%\]
%Since the two terms in the above some are complex conjugates of each other, their sum is equal to twice their real part. That is,
%\[
%\bra{\Psi_{ABE}} X_A\otimes X_B \otimes I_E \ket{\Psi_{ABE}}
%=2\Re\bra{u_0}_{BE}X_B\otimes I_E\ket{u_1}_{BE}
%=2\Re\bra{u_1}_{BE}X_B\otimes I_E\ket{u_0}_{BE}.
%\]
%}
\end{enumerate}
A similar bound can be obtained for $p_Z$.

Suppose Alice measures her qubit in the computational basis: the post-measurement state on $A$ and $E$ (tracing out $B$) can be written as $\rho_{AE}^Z = \ketbra{0}{0}_A\otimes \sigma_E^{Z,0} + \ketbra{1}{1}_A\otimes \sigma_E^{Z,1}$. Similarly, if Alice measures in the Hadamard basis we may write the post-measurement state as $\rho_{AE}^X = \ketbra{+}{+}_A\otimes \sigma_E^{X,+} + \ketbra{-}{-}_A\otimes \sigma_E^{X,-}$.
\begin{enumerate}
\item[4.] Use the previous two questions to determine coefficients $\alpha,\beta$ such that
$$ 2p-1 \leq \alpha F(\sigma_E^{X,0},\sigma_E^{X,1}) + \beta F(\sigma_E^{Z,+},\sigma_E^{Z,-})$$
where $F$ denotes the fidelity. [Hint: observe that $\ket{u_0}_{BE}$ and $\ket{u_1}_{BE}$ considered in the previous question are purifications of $\sigma_E^{Z,0}$ and $\sigma_E^{Z,1}$ respectively, and use Uhlmann's theorem]
%\solopen{First, observe that by part b),
%\[
% 2p-1
% = \frac 12\bra{\Psi_{ABE}} X\otimes X \otimes I \ket{\Psi_{ABE}}+ \frac 12\bra{\Psi_{ABE}} Z\otimes Z \otimes I \ket{\Psi_{ABE}}.
% \]
%By part c),
%\[
% 2p-1
% =\Re\bra{u_0}X_B\otimes I_E\ket{u_1}
% +\Re\bra{u_0}Z_B\otimes I_E\ket{u_1}.
% \]
% By Ulhmann's theorem,
% \[
%\abs{\bra{u_0}X_B\otimes I_E\ket{u_1}} \leq F(\sigma_E^{X,0},\sigma_E^{X,1}) \text{ and }
%\abs{\bra{u_0}Z_B\otimes I_E\ket{u_1}} \leq F(\sigma_E^{Z,+},\sigma_E^{Z,-}).
% \]
% Finally, notice that for any complex $z$, $\Re z \leq \abs z$. Chaining and adding inequalities gives the desired inequality with $\alpha = \beta = 1$.
% \[
%|2p-1| \leq  F(\sigma_E^{X,0},\sigma_E^{X,1}) +  F(\sigma_E^{Z,+},\sigma_E^{Z,-}).
% \]
%}
\item[5.] Recall the inequality $D(\rho,\sigma) \leq \sqrt{1-F(\rho,\sigma)^2}$. Using also the definition of $\Hmin (X|E)$, what is the best lower bound on $\Hmin(X|E)$ as a function of $p$ that you can get?
%\solopen{Recall that from part d) we have
%\begin{equation}
%2p-1 \leq \alpha F(\sigma_E^{X,0},\sigma_E^{X,1}) + \beta F(\sigma_E^{Z,+},\sigma_E^{Z,-})
%\end{equation}
%Now, $D(\rho,\sigma) \leq \sqrt{1-F(\rho,\sigma)^2} \Rightarrow F(\rho,\sigma) \leq \sqrt{1-D(\rho,\sigma)^2}$. Hence, we have
%\begin{equation}
%2p-1 \leq \sqrt{1-D(\sigma_E^{X,0},\sigma_E^{X,1})^2} + \sqrt{1-D(\sigma_E^{Z,+},\sigma_E^{Z,-})^2}
%\end{equation}
%Now, from the discussion at the start of the problem, we have the following lower bound on $\Hmin (X|E)$.
%\begin{equation}
%\Hmin (X|E) \geq -\log \big(\frac12(\frac12+\frac12 D(\sigma_E^{X,0},\sigma_E^{X,1}) +\frac12(\frac12+\frac12 D(\sigma_E^{Z,+},\sigma_E^{Z,-}))\big) \\
%\end{equation}
%Simplifying the right-hand side results in
%\begin{equation}
%\Hmin (X|E) \geq 1 - \log \big(1 + \frac{D(\sigma_E^{X,0},\sigma_E^{X,1}) + D(\sigma_E^{Z,+},\sigma_E^{Z,-})}{2}\big)
%\end{equation}
%We want to find the maximum value of $D(\sigma_E^{X,0},\sigma_E^{X,1}) + D(\sigma_E^{Z,+},\sigma_E^{Z,-})$ subject to $2p-1 \leq \sqrt{1-D(\sigma_E^{X,0},\sigma_E^{X,1})^2} + \sqrt{1-D(\sigma_E^{Z,+},\sigma_E^{Z,-})^2}$.
%We look at this as an optimization problem. The maximum value of $x+y$ subject to the constraint $\sqrt{1-x^2} + \sqrt{1-y^2} \geq \alpha$ is achieved when $\sqrt{1-x^2} + \sqrt{1-y^2} = \alpha$. Hence, we can use the Lagrange multiplier method to find that the maximum value of $x+y$ is $\sqrt{4-\alpha^2}$. Plugging in $\alpha = 2p-1$ gives that the maximum value of $x+y$ is $2\sqrt{p(1-p)+\frac34}$. Plugging this into the inequality for the min-entropy above gives the desired bound
%\begin{equation}
%\Hmin (X|E) \geq 1 - \log\big(1+\sqrt{p(1-p)+ \frac34}\,\,\big)
%\end{equation}
%}
\end{enumerate}


\end{enumerate}
\end{document}






 
















