\documentclass[12pt]{article}
\usepackage{fullpage}
\usepackage{amssymb,amsmath}

\newtheorem{theorem}{Theorem}

 \newcommand{\Header}[1]{\begin{center} {\Large\bf #1} \end{center}}
 \newcommand{\header}[1]{\begin{center} {\large\bf #1} \end{center}}
\setlength{\parindent}{0.0in}
\setlength{\parskip}{1ex}


%\newif\ifnotes\notestrue
\newif\ifnotes\notesfalse


\input{../com440-default.tex}
\input{../com440-macros.tex}



\begin{document}
\header{COM-440, Introduction to Quantum Cryptography, Fall 2025}
{\bf Final} \hfill {\bf date: January 13th, 2026}


\medskip

\hrule

\medskip 

{\bf Please
  format your solutions so that each problem begins on a new page, and
  so that your SCIPER appears at the top of each page.}

\medskip
\hrule
\medskip

%The total points value of the problems is 25 points. Your midterm grade will be the \emph{minimum} of your total points number and \emph{20}. This means that we do not expect you to solve all problems. Instead, we encourage you to spend the first 5-10 minutes looking at all problems and deciding which ones to attempt. Your goal is to collect as close to 20 points as possible in total, not necessarily to solve all questions. 

The final has 13 short questions, to be handed in on this sheet of paper (total: 6.5pts) and 3 problems to be handed in on your own paper (total: 16pts), for a total of 8 single-sided sheets of paper. Your total out of 22.5 points will be scaled down to a grade out of 20 which will constitute your final grade. 

		
\section{Short questions}

Circle the correct answer directly on this sheet of paper, and turn it in with your SCIPER number clearly marked at the top. \emph{(1/2pt per question)}
\begin{enumerate}
\item Alice encodes a single qubit in state $\ket{\psi}$ using the quantum one-time pad. An adversary Eve has no information at all about Alice's two key bits $k_1$ and $k_2$. What is the state of the encoded qubit from the point of view of Eve?
\begin{enumerate}
\item $\rho = \frac{1}{2} \left(\proj{\psi} + XZ\proj{\psi}ZX\right)$
\item {$\rho = \frac{\mathbb{I}}{2}$}
\item $\rho =  X^{k_1} Z^{k_2}\proj{\psi}Z^{k_2}X^{k_1}$
\end{enumerate} 
\item In the same setup, what is the state of the encoded qubit as seen by a third party Bob, who does know the key bits $k_1$ and $k_2$?
\begin{enumerate}
\item $\rho = \frac{1}{2} \left(\proj{\psi} + XZ\proj{\psi}ZX\right),$
\item $\rho = \frac{\mathbb{I}}{2},$
\item {$\rho =  X^{k_1} Z^{k_2}\proj{\psi}Z^{k_2}X^{k_1}$}
\end{enumerate} 
\item True or false: Any scheme for sharing a \textit{classical} secret among $n$ parties in such a way that no single party can recover the secret alone requires at least $n/2$ shares to recover the secret.
\begin{enumerate}
\item True
\item False
\end{enumerate} 
\item Charlie wants to share a 4-bit classical secret between Alice and Bob in such a way that neither can recover it alone. What is the minimum number of qubits either Alice or Bob must hold?
\begin{enumerate}
	\item 1
	\item 2
	\item 3
	\item 4
\end{enumerate}
\item Consider the cq-state
\begin{equation}
\rho_{XE} = \frac{1}{4} \proj{0}_X \otimes \proj{+}_{E} + \frac{3}{4} \proj{1}_X \otimes \proj{-}_{E}.
 \end{equation}
What is the conditional min-entropy $\Hmin(X|E)$ of this state?
\begin{enumerate}
\item {$\Hmin(X|E) = 0$}
\item $\Hmin(X|E) = 2 - \log{3}$
\item $\Hmin(X|E) = 2 - \frac{3}{4}\log{3}$
\item $\Hmin(X|E) = 1$
\end{enumerate}
\item Recall that in the tripartite guessing game Eve prepares a state $\rho_{AEB}$ such that Alice and Bob each get a single qubit $A$ and $B$ respectively, while Eve keeps an arbitrary state. Alice chooses a random basis $\theta\in\{0,1\}$, measures her qubit to obtain a bit $x_A$, and publicly announces $\theta$. Bob measures in the same basis as Alice to obtain a bit $x_B$. Eve's goal is to produce a bit $x_E$ such that the probability that $x_A=x_B=x_E$ is maximized. \\
Suppose that Eve prepares the initial state $\rho_{AEB} = \proj{\psi}_{AE} \otimes \proj{0}_B$, where $\ket{\psi}_{AE} = \frac{1}{\sqrt{2}}\left(\ket{00}_{AE} + \ket{11}_{AE}\right)$ is a maximally entangled state. What is the optimal probability that Eve guesses Alice's outcome?
\begin{enumerate}
\item $\frac{1}{2}$
\item $\frac{3}{4}$
\item $\frac{1}{2}\left(1 + \frac{1}{\sqrt{2}}\right) \approx 0.85$
\item {$1$}
\end{enumerate}
\item In the same setup, what is the optimal probability that Bob guesses Alice's outcome?
\begin{enumerate}
\item {$\frac{1}{2}$}
\item $\frac{3}{4}$
\item $\frac{1}{2}\left(1 + \frac{1}{\sqrt{2}}\right) \approx 0.85$
\item $1$
\end{enumerate}
\item Consider again the same guessing game, except that now the inital state is the GHZ state $\ket{GHZ}_{ABE} = \frac{1}{\sqrt{2}}\left(\ket{000}_{ABE} + \ket{111}_{ABE}\right)$. Can both Eve and Bob guess Alice's measurement outcome in the standard basis with full certainty?
\begin{enumerate}
\item {Yes}
\item No
\end{enumerate}
\item Suppose $\Ext: \{0,1\}^n\times \{0,1\}^d\rightarrow \{0,1\}^m$ is a $(k,\eps)$ strong extractor. For which of the following random variables $X$ and $Y$ is it  true that $\|\rho_{Ext(X,Y)YE} - I\otimes \rho_{YE}\|_{tr} \leq \eps$? Mark all that apply. 
\begin{enumerate}
	\item $X$ is uniform and independent of $Y$ and $E$, and $Y$ is such that \mbox{$H(Y| E) \geq k$}.
	\item $X$ is a such that $H(X| E) = k-1$, and $Y$ is uniform and independent of $X$ and $E$.
	\item {$X$ is such that $H(X| E) \geq k$, and $Y$ is uniform and independent of $X$ and $E$.}
	\item $X$ is such that $H(X| E) \geq k$, and $Y$ is uniform with $H(Y| X) < d$.
\end{enumerate}
\item
Alice and Bob communicate over a special classical channel such that Bob correctly receives all the bits from Alice. However, Eve receives a bit $b_E$ that is equal to Alice's bit with probability $q=\frac{1}{2}$ and with probability $1-q=\frac{1}{2}$ equal to Alice's bit flipped.
Is it necessary for Alice and Bob to perform randomness extraction on their strings to reduce Eve's knowledge about the key?
\begin{enumerate}
\item Yes, Alice and Bob need to perform randomness extraction, since there is a non-zero probability that Eve received Alice's key bit.
\item {No, randomness extraction is not required, because Eve holds no information about the key.}
\end{enumerate}
\item Now the channel between Alice and Bob has been modified such that Bob still receives all the bits from Alice, but Eve always receives Alice's bit flipped. Is it now necessary for Alice and Bob to perform randomness extraction on their bit strings to reduce Eve's knowledge about the key?
\begin{enumerate}
\item Yes, Alice and Bob need to perform randomness extraction, to reduce Eve's knowledge about the key.
\item No, randomness extraction is not required, because Eve never receives the key bit, so she holds no information about the key.
\item {Alice and Bob cannot obtain the key in this scenario, because Eve has as much information about the key as Bob has.}
\end{enumerate}
\item 
In the device-independent setting, attacks by Eve can be modeled by specifying what kinds of devices she gives to Alice and Bob. Which of the following attacks do we hope our device-independent protocol to protect against? Circle all that apply.
\begin{enumerate}
\item Alice's devices communicate with Bob's devices during the protocol.
\item Eve gets to examine Alice and Bob's devices at the end of the protocol.
\item Alice's devices send information to Eve during the protocol.
\item {Eve's laboratory is arbitrarily entangled with Alice and Bob's laboratory at the beginning of the protocol.}
\end{enumerate}
\item Consider the following protocol for bit commitment: Alice prepares \(\ket{\psi_{00}}_{AB} = \frac{1}{\sqrt{2}}\left(\ket{00} + \ket{11}\right)\) if she commits to \(x=0\), or she prepares \(\ket{\psi_{01}}_{AB} = \frac{1}{\sqrt{2}}\left(\ket{00} - \ket{11}\right)\) if she commits to \(x=1\). Then she sends the register \(B\) to Bob. Finally, in the open phase, Alice sends Bob her register \(A\), so that Bob can perform a measurement in the Bell basis on the two qubits in registers \(A\) and \(B\) to learn Alice's bit. Is this protocol correct and secure?
\begin{enumerate}
\item Yes
\item {No}
\end{enumerate}
\end{enumerate}

\newpage


\section{Problems}

\begin{enumerate}
\item \emph{(4 points)} \textbf{A Guessing Game.}\\
Imagine that Alice and Eve play a guessing game where they share a two-qubit state \(\rho_{AE}\). First, Alice produces a random bit \(\theta\in\{0,1\}\), and she measures her qubit in the standard basis if \(\theta=0\) and in the Hadamard basis if \(\theta=1\). In both cases she obtains a bit \(x\in\{0,1\}\) as measurement outcome. She then announces \(\theta\) to Eve. Eve's goal is to guess the bit \(x\). Imagine that \(\rho_{AE} = |\mathrm{EPR}\rangle\langle\mathrm{EPR}|\), where as usual $\ket{\mathrm{EPR}} = \frac{1}{\sqrt{2}}(\ket{00}+\ket{11})$, so Alice and Eve share a maximally entangled pair of qubits. In this scenario we know that if Eve measures in the same basis as Alice she will get the same outcome and  thus be able to guess \(x\) perfectly.
\begin{enumerate}
\item Suppose now that Alice wants to foil Eve so, before measuring, she first applies some unitary \(U_A\) to her qubit, and then measures. Of course Eve, being really smart, gets wind of this so she will know what unitary Alice has used before measuring. So they share the state\\
\[|\Phi_U\rangle = (U_A\otimes \mathbf{1}_E)\frac{1}{\sqrt{2}}(\ket{00}+ \ket{11})\]
and Eve knows \(\theta\) and \(U_A\). In this scenario, what is Eve's optimal guessing probability, and what is a strategy that achieves it? 
\item Consider now a scenario in which Alice's strategy consists in choosing one out of three possible unitaries, according to a distribution that may depend on her choice of $\theta$. The three unitaries are the same whether $\theta=0$ or $\theta=1$, and Eve knows what they are as well as the distribution used by Alice, but she does not learn which unitary Alice eventually selected. Provide a set of three unitaries that makes Eve's guessing probability the lowest possible. (You do not need to prove that your strategy is optimal.)
%We can achieve guessing 1/2 by using a distrubition over I,X,Z. 
\item Suppose we restrict Alice's set of possible unitaries to contain only two. Can she still make Eve's guessing probability as low as in part (b)?
%Yes: randomly choose between I and XZ
\end{enumerate}


\item \emph{(4 points)} \textbf{Thinking adversarially}.\\
In this problem you are asked to play the role of the eavesdropper Eve in a QKD protocol. Eve observes two
parties, Alice and Bob, trying to implement a certain protocol. Because QKD is
hard, Alice and Bob might try to cut corners in the implementation of their protocol.
Here are two suggested protocols that Alice and Bob might want to implement. For
each of them, either argue (in broad lines) security or provide an explicit attack for Eve. (If arguing security, you will be arguing that for some ``reasonable'' choice of the unspecified parameters, such as for privacy amplification, Alice and Bob can obtain a secure key based on the template provided.)

\emph{Protocol 1:}\\
Alice and Bob can communicate through a classical authenticated channel, and a
quantum (non-authenticated) channel.
\begin{enumerate}
\item Alice generates bit strings $x, \theta \in\{0, 1\}^n$ uniformly at random.
\item Alice prepares qubits $|x_i\rangle_{\theta_i}$ for $i = 1,\ldots, n$ where as usual $\ket{x}_\theta=H^\theta|x\rangle$, and sends them to Bob.
\item Alice announces the basis string $\theta$.
\item Bob measures the qubits he received according to the bases specified by the string
$\theta$ and obtains a string $x'$. 
\item Alice randomly selects a subset $T\subseteq\{1,\ldots,n\}$ of size $|T|=n/2$ and announces it to Bob. Alice, Bob exchange $x_T$ and $x'_T$ and abort if $x_T\neq x'_T$. 
\item Alice and Bob perform information reconciliation and privacy amplification, on the strings $x_S$ and $x'_S$ respectively, where $S=\{1,\ldots,n\}\backslash T$, with adequate parameters to obtain a shared key. 
\end{enumerate}

Protocol 2:
\begin{enumerate}
\item Alice creates $n$ EPR pairs and sends one half of each to Bob.
\item She generates a string $\theta\in \{0, 1\}^n$ uniformly at random and measures her half of each pair according
to the corresponding bit of $\theta$ (standard basis for $0$, Hadamard for $1$)
\item Bob generates a random string $\theta'$, and similarly measures his half of the EPR
pairs. Then Bob announces over an authenticated channel that he received and
measured his qubits.
\item Alice and Bob announce $\theta$ and $\theta'$ over an authenticated channel.
\item Alice randomly selects a subset $T\subseteq\{i: \theta_i=\theta'_i\}$ of size $|T|=n/4$ and announces it to Bob. Alice, Bob exchange $x_T$ and $x'_T$ and abort if $x_T\neq x'_T$. 
\item Alice and Bob perform information reconciliation and privacy amplification, on the strings $x_S$ and $x'_S$ respectively, where $S=\{i: \theta_i=\theta'_i\}\backslash T$, with adequate parameters to obtain a shared key. 
\end{enumerate}




\item \emph{(8 points)} {\bf A Simple Quantum Bit Commitment Protocol}\\
As you know, perfectly secure quantum bit commitment is impossible. Nonetheless, it is possible to construct protocols in which Alice and Bob can cheat to some extent, but not completely. \\
For a cheating Alice and honest Bob, we define Alice's cheating probability as \[ P_A^*= \frac{1}{2}\big(\Pr[\mbox{Alice opens $b=0$ successfully}]+\Pr[\mbox{Alice opens $b=1$ successfully}]\big)\;,\]
 maximized over Alice's (cheating) strategies. For a cheating Bob and an honest Alice, instead, we let Bob's cheating probability be $$P_B^* = \Pr[\mbox{Bob guesses b after the commit phase}]\;,$$ maximized over Bob's (cheating) strategies. The cheating probability of the protocol as a whole is then defined as $\max \{P_A^*,P_B^*\}$. In this question, we introduce a simple example of such a protocol:
\begin{itemize}
\item \textit{Commit phase}: Alice commits to bit $b$ by preparing the state
$$\ket{\psi_b} = \sqrt{\alpha} \ket{bb} + \sqrt{1-\alpha}\ket{22}$$ and Alice sends the second qutrit to Bob. Here, $0\leq \alpha\leq 1$ is a parameter that we will optimize over at the end. 
\item \textit{Open phase}: Alice reveals the classical bit $b$ and sends the first qutrit over to Bob, who checks that the pure state is the correct one by making a measurement with respect to any orthogonal basis containing $\ket{\psi_b}$.
\end{itemize}
\begin{enumerate}
\item What is the density matrix $\rho_b$ that Bob has after the \textit{commit phase} if Alice has committed to bit $b$ and honestly prepared state $\ket{\psi_b}$?
\item Compute Bob's cheating probability $P_B^*$ by recalling the operational interpretation of the trace distance.
\end{enumerate}
Next, let's calculate Alice's cheating probability. Let the underlying Hilbert space be $\mathcal{H} \otimes \mathcal{H}_s \otimes \mathcal{H}_t$, where $\mathcal{H}_t$ corresponds to the qutrit that is sent to Bob in the commit phase, $\mathcal{H}_s$ to the qutrit that is sent during the opening phase, and $\mathcal{H}$ is any auxiliary system that Alice might use. For the most general strategy, we can assume that she prepares the pure state $\ket{\phi}$, as it can always be purified on $\mathcal{H}$.\\
We can write  $\ket{\phi} = \sum_{i} \sqrt{p_i} \ket{i} \ket{\tilde{\psi}_{i,b}}$ where $\{\ket{i}\}$ and $\{\ket{\tilde{\psi}_{i,b}}\}$ are vectors obtained from the Schmidt decomposition across $\mathcal{H}$ and $\mathcal{H}_s \otimes \mathcal{H}_t$ respectively. So, the reduced density matrix on $\mathcal{H}_s \otimes \mathcal{H}_t$ is $\sigma_b = \sum_{i} p_i  \ket{\tilde{\psi}_{i,b}} \bra{\tilde{\psi}_{i,b}} $. Moreover, let $\sigma$ be Bob's reduced density matrix after the commit phase, i.e. just a qutrit.
\begin{enumerate}
\item[(c)] Compute the probability of dishonest Alice successfully opening bit $b$ in terms of the fidelity of two density matrices, and hence give an upper bound on Alice's cheating probability. \textit{[Hint: use the fact that the fidelity is non-decreasing under taking partial trace, in particular tracing out system $\mathcal{H}_s$.]}
\item[(d)] Give an upper bound to Alice's cheating probability in terms of $\alpha$. \textit{[Hint: You might find useful the inequality $F^2(\rho_1,\rho_2) + F^2(\rho_1,\rho_3) \leq 1+ F(\rho_2,\rho_3) $ for arbitrary density matrices $\rho_1,\rho_2, \rho_3$.]}
\end{enumerate}
Note that the bound on Bob's cheating probability that you obtained in (b) is tight, since it is the best possible probability of distinguishing between two known states, and he knows what the two states are when Alice is honest. \\
Importantly, the bound  on Alice's cheating probability that we obtained in (d) is also tight. There is a simple cheating strategy that allows Alice to achieve this bound, without even making use of the ancillary system $\mathcal{H}$.
\begin{enumerate}
\item[(e)] Which of the following states of two qutrits can Alice prepare to achieve the bound in (d)?
\begin{enumerate}
\item $\ket{\psi_0} + \ket{\psi_1}$, normalized.
\item $\ket{\psi_0} - \ket{\psi_1}$, normalized.
\item $\ket{\psi_0} + \frac{\sqrt{3}}{2} \ket{\psi_1}$, normalized.
\end{enumerate}
\item[(f)] By combining the calculations so far on Alice and Bob's cheating probabilities, determine the $\alpha$ that minimizes the overall cheating probability $\max \{P_A^*,P_B^*\}$ of the protocol.
\end{enumerate}

\item \emph{(8 points)} {\bf Cloning attacks NEED TO EDIT BASED ON PDF}\\ 
In this problem we study the effectiveness of a simple cloning attack for the eavesdropper in the BB84 key distribution protocol. Recall that in the protocol Alice prepares $N$ single-qubit states $\ket{x_j}_{\theta_j}$, for $j\in\{1,\ldots,N\}$ and random $x_j,\theta_j\in\{0,1\}$, and sends each of these states to Bob. 

Now suppose the eavesdropper Eve intercepts each of the states sent by Alice, and does the following: 
\begin{enumerate}
\item[(i)] With probability $1-p$, she applies the cloning map $T_1$ from Problem 6(a) in HW2. She keeps the second qubit and forwards the first qubit to Bob. 
\item[(ii)] With probability $p$, she applies the cloning map $T_2$ from Problem 6(b) in HW2. She keeps the second qubit, traces out (i.e. ignores) the third qubit, and forwards the first to Bob. 
\end{enumerate}
For simplicity, first assume $N=1$. Based on the results of HW2 Problem 6 (you may consult the solution available online), evaluate the following:
\begin{enumerate}
\item[(a)] Suppose both Alice and Bob measure their qubit in the correct basis $\theta=\theta_1$. If $p=0$, what is the probability that they get the same outcome (recall $\theta\in\{0,1\}$ is chosen uniformly at random). Same question if $p=1$. Same question for a general $0<p<1$. \tnote{For this first question it may be helpful to give them the answer and ask them to prove it; to build confidence and avoid silly mistakes that would make them get all the questions wrong}
\item[(b)] Answer the same questions, where now Alice and Eve measure their qubit. What is the probability that they get the same outcome? 
\item[(c)] What is the probability that all of Alice, Bob and Eve all obtain the same outcome, if they each measure their respective qubit in basis $\theta$? (Answer for a general $p$.)
\end{enumerate}
\tnote{answers to the questions will be important for the rest. Are they in the HW2 solutions? If not, maybe we should give them away, or find a way to replace whatever answer they got by a parameter, so they don't lose points later if they get it wrong here.}
Let's continue with the BB84 protocol. We now consider a number of rounds $N=4n$. Suppose that in $2n$ of the rounds (exactly), Alice and Bob happen to make the same basis choice; call these the agreement rounds, $R\subseteq\{1,\ldots,N\}$. They select exactly $n$ of these rounds for testing; call these rounds the testing rounds, $T \subseteq R$. You may assume all rounds behave the same. 
\begin{enumerate}
\item[(d)] What is the expected number of errors (non-agreement of their measurement outcomes) that Alice and Bob will notice in the testing rounds $T$, as a function of $p$?
\item[(e)] Invert the previous bound: as a function of the fraction $\delta$ of errors detected in the testing rounds, what is a reasonable estimate $\hat{p}$ for $p$ that Alice and Bob could come up with? 
\item[(f)] Suppose Alice and Bob make a guess $\hat{p}$ for $p$ based on the method from the previous question. Using question (b), deduce a bound on the min-entropy $\Hmin(A|E)$ per round that they could estimate for the rounds in $K = R\backslash T$. 
\item[(g)] Conclude: how many bits of key, as a function of $p$ and $N$, can Alice and Bob reasonably hope to generate from the protocol? \emph{[Hint: This is a subtle calculation. Alice and Bob will have to perform both information reconciliation and privacy amplification on the rounds in $K$. First, estimate the number of bits they will need to exchange to perform information reconciliation. Second, deduce a bound on the min-entropy of the resulting agreed-on string. Third, use the best privacy amplification method you know of to maximize the length of extracted key]}
\tnote{I am not sure if this is too much. Maybe the question should be split in two. In any case I wouldn't want to put too many points on it: what's important is they get the idea, not necessarily every single number}
\end{enumerate}


\end{enumerate}
\end{document}






 
















